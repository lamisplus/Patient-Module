<?xml version="1.0" encoding="utf-8"?>
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.5.xsd">

    <property name="autoIncrement" value="true"/>

    <changeSet id="202220421-001" author="amos-data-fi">
        <sql>
            CREATE TABLE person
            (
                id                         BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
                active                     BOOLEAN                                 NOT NULL,
                contact_point              JSONB,
                address                    JSONB,
                gender                     JSONB,
                identifier                 JSONB,
                deceased                   BOOLEAN,
                deceased_date_time         TIMESTAMP WITHOUT TIME ZONE,
                marital_status             JSONB,
                employment_status          JSONB,
                education                  JSONB,
                organization               JSONB,
                contact                    JSONB,
                date_of_birth              date                                    NOT NULL,
                date_of_registration       date                                    NOT NULL,
                date_created               TIMESTAMP WITHOUT TIME ZONE,
                created_by                 VARCHAR(255),
                date_modified              TIMESTAMP WITHOUT TIME ZONE,
                modified_by                VARCHAR(255),
                archived                   INTEGER,
                uuid                       VARCHAR(255),
                first_name                 VARCHAR(255),
                surname                    VARCHAR(255),
                other_name                 VARCHAR(255),
                is_date_of_birth_estimated BOOLEAN,
                CONSTRAINT pk_person PRIMARY KEY (id)
            );
        </sql>
    </changeSet>
    
    <changeSet id="20220805-003" author="amos-data-fi">
        <sql>
            CREATE TABLE vital_sign
            (
                id                 BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
                created_by         VARCHAR(255),
                created_date       TIMESTAMP WITHOUT TIME ZONE,
                last_modified_by   VARCHAR(255),
                last_modified_date TIMESTAMP WITHOUT TIME ZONE,
                body_weight        DOUBLE PRECISION,
                diastolic          DOUBLE PRECISION,
                encounter_date     date,
                height             DOUBLE PRECISION,
                person_id          BIGINT,
                service_type_id    BIGINT,
                systolic           DOUBLE PRECISION,
                archived           INTEGER,
                CONSTRAINT pk_vital_sign PRIMARY KEY (id)
            );

            ALTER TABLE vital_sign
                ADD CONSTRAINT FK_VITAL_SIGN_ON_PERSON FOREIGN KEY (person_id) REFERENCES person (id);
        </sql>
    </changeSet>

</databaseChangeLog>
